<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES6 function* , yeild, Promise | AME_BLOG</title>
    <meta name="description" content="Generator">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.7a2ad57b.css" as="style"><link rel="preload" href="/assets/js/app.60ce1d25.js" as="script"><link rel="preload" href="/assets/js/3.b2331f66.js" as="script"><link rel="preload" href="/assets/js/21.22431cb8.js" as="script"><link rel="prefetch" href="/assets/js/1.96f3f0fb.js"><link rel="prefetch" href="/assets/js/10.769cada3.js"><link rel="prefetch" href="/assets/js/11.a50d5f49.js"><link rel="prefetch" href="/assets/js/12.f379d991.js"><link rel="prefetch" href="/assets/js/13.5af28ca4.js"><link rel="prefetch" href="/assets/js/14.29b1ff2e.js"><link rel="prefetch" href="/assets/js/15.a61fb83e.js"><link rel="prefetch" href="/assets/js/16.0064d143.js"><link rel="prefetch" href="/assets/js/17.570f6c42.js"><link rel="prefetch" href="/assets/js/18.cd5255f6.js"><link rel="prefetch" href="/assets/js/19.0598ee7a.js"><link rel="prefetch" href="/assets/js/20.b827a594.js"><link rel="prefetch" href="/assets/js/22.762e605b.js"><link rel="prefetch" href="/assets/js/23.c526d1c0.js"><link rel="prefetch" href="/assets/js/24.b4133753.js"><link rel="prefetch" href="/assets/js/4.ad855f47.js"><link rel="prefetch" href="/assets/js/5.08321ba4.js"><link rel="prefetch" href="/assets/js/6.3e6521f4.js"><link rel="prefetch" href="/assets/js/7.251fc9fd.js"><link rel="prefetch" href="/assets/js/8.4dc0718b.js"><link rel="prefetch" href="/assets/js/9.e21b00f8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a2ad57b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">AME_BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/intro/" class="nav-link">介绍</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/intro/" class="nav-link">介绍</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/css/ellipsis.html" class="sidebar-link">文本溢出显示省略号</a></li><li><a href="/note/css/vertical.html" class="sidebar-link">居中对齐</a></li><li><a href="/note/css/background-clip.html" class="sidebar-link">css background-clip属性</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/js/f11_fullscreen.html" class="sidebar-link">F11效果浏览器窗口全屏</a></li><li><a href="/note/js/window_location.html" class="sidebar-link">window.location对象</a></li><li><a href="/note/js/design_mode.html" class="sidebar-link">设计模式</a></li><li><a href="/note/js/math_fn.html" class="sidebar-link">常用的Math数学对象函数</a></li><li><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html" class="active sidebar-link">ES6 function* , yeild, Promise</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#语法及基本应用" class="sidebar-link">语法及基本应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#生成器函数定义" class="sidebar-link">生成器函数定义</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#关键字yield——迭代器生成器" class="sidebar-link">关键字yield——迭代器生成器</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#迭代器-generator" class="sidebar-link">迭代器(Generator)</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#核心-迭代器" class="sidebar-link">核心-迭代器</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#核心-yield关键字" class="sidebar-link">核心-yield关键字</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#异步调用中的应用" class="sidebar-link">异步调用中的应用</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#总结" class="sidebar-link">总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#yield" class="sidebar-link">yield</a></li><li class="sidebar-sub-header"><a href="/note/js/ES6_GeneratorFunction_yeild_promise.html#yield-2" class="sidebar-link">yield*</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/node/unexpected_token_import.html" class="sidebar-link">编译报错Unexpected token import</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/git/git_error.html" class="sidebar-link">git 报错</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="es6-function-yeild-promise"><a href="#es6-function-yeild-promise" aria-hidden="true" class="header-anchor">#</a> ES6 function* , yeild, Promise</h1> <p>生成器函数（Generator）的特点是定义函数的时候有个'*'，通过调用函数生成一个控制器，调用next()方法开始执行函数，遇到yield函数将暂停，保留当前的进度并返回yield后面的表达式，再次调用next()将继续执行函数。</p> <h2 id="语法及基本应用"><a href="#语法及基本应用" aria-hidden="true" class="header-anchor">#</a> 语法及基本应用</h2> <h3 id="生成器函数定义"><a href="#生成器函数定义" aria-hidden="true" class="header-anchor">#</a> 生成器函数定义</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>普通函数添加*号后则成为了成为了生成器函数了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span> <span class="token comment">// 显示[object GeneratorFunction]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>生成器函数的行为与普通函数并不相同，表现为如下3点：</p> <ol><li>通过new运算符或函数调用的形式调用生成器函数，均会返回一个生成器实例；</li></ol> <p>2. 通过new运算符或函数调用的形式调用生成器函数，均不会马上执行函数体的代码；</p> <ol start="3"><li>必须调用生成器实例的next方法才会执行生成器函数体的代码。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span> <span class="token comment">// 没有显示hello world</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 显示[object Generator]</span>
gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 显示hello world</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="关键字yield——迭代器生成器"><a href="#关键字yield——迭代器生成器" aria-hidden="true" class="header-anchor">#</a> 关键字yield——迭代器生成器</h3> <p>用于马上退出代码块并保留现场，当执行迭代器的next函数时，则能从退出点恢复现场并继续执行下去。下面有2点需要注意：</p> <ol><li><p>yield后面的表达式将作为迭代器next函数的返回值；</p></li> <li><p>迭代器next函数的入参将作为yield的返回值（有点像运算符）。</p></li></ol> <h3 id="迭代器-generator"><a href="#迭代器-generator" aria-hidden="true" class="header-anchor">#</a> 迭代器(Generator)</h3> <p>迭代器是一个拥有 {value:{<em>}, done:{Boolean}} next([</em>])方法 和 {undefined} throw([*])方法 的对象，通过next函数不断执行以关键字yield分割的代码段，通过throw函数令yield分割的代码段抛出异常。</p> <h2 id="核心-迭代器"><a href="#核心-迭代器" aria-hidden="true" class="header-anchor">#</a> 核心-迭代器</h2> <p>迭代器更多的是指迭代器模式，迭代器模式是指通过一个名为迭代器的对象按一定的规则遍历集合元素，调用者只需告诉迭代器获取下一个元素即可，而集合的类型、如何获取元素等因素均由具体的迭代器自行处理。（又一次地关注点分离！）并且由于迭代器模式可以做到 按需执行/延迟执行 的效果，因此能降低遍历无限序列时内存/栈溢出的问题，也能作为异步编程模式使用。</p> <p>模式理解的注意点：</p> <p>1. 迭代器每次进访问集合的一个元素，并由调用者发起访问请求时迭代器才执行下一次访问操作</p> <p>2. “按一定的规则”，意味着不一定遍历集合中所有的元素，并且规则可以内聚到迭代器的具体实现上，也可通过策略模式外移到其他模块中；</p> <p>3. “集合”，集合可以是一开始就已经初始化好的有限序列集合（如[1,2,3,4,5,6,7]），也可以是按需生成的无限序列集合（如1到无限大）</p> <p>4. “集合元素”，可以是整数集合、字符串集合等数据集合，也可以是函数等指令+数据的集合；</p> <p>若接触过C#、Java等服务端语句的朋友应该对迭代器有一定程度的了解，C#的IEnumrable、IEnumerator和Java的Iterable、Iterator就是跟迭代器相关的接口定义，继承上述接口的迭代器实现均可以通过foreach或for...in语句作循环操作。</p> <p>那么这里有2点是要注意的：</p> <p>1. 迭代器是指设计模式，跟具体的语言无关，因此所有语言均可根据该模式实现具体的迭代器；</p> <p>2. foreach或for...in语句是语法层面的支持，跟迭代器模式没有必然联系。（若语法层面不支持，那函数式编程中的递归的效果是一样的，假如编译器/解析器支持尾递归则更好了，可以JS不支持）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 迭代器构造函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">RangeIterator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span>end<span class="token punctuation">,</span>scan</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">2</span> <span class="token operator">?</span> start <span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> end <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> start <span class="token punctuation">:</span> end
    <span class="token keyword">this</span><span class="token punctuation">.</span>scan <span class="token operator">=</span> scan <span class="token operator">||</span> <span class="token number">1</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>idx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>start
<span class="token punctuation">}</span>
<span class="token comment">// 向迭代器发起访问下一个元素的请求</span>
<span class="token comment">// FF和ES6下迭代器接口规范定义了迭代器必须通过名为next的函数发起访问下一个元素的请求</span>
<span class="token class-name">RangeIterator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">next</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>idx <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>end<span class="token punctuation">)</span>
　　　　<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">!</span><span class="token operator">!</span>StopIteration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       　　<span class="token keyword">throw</span> StopIteration
       <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token keyword">void</span> <span class="token number">0</span>
       <span class="token punctuation">}</span>

    <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>idx
    <span class="token keyword">this</span><span class="token punctuation">.</span>idx <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scan
    <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
<span class="token comment">// Python中的range函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">range</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> scan</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RangeIterator</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> scan<span class="token punctuation">)</span>
   <span class="token keyword">return</span> <span class="token punctuation">{</span>
       <span class="token comment">// FF下令for...in语句调用对象的迭代器的接口规范</span>
        <span class="token function-variable function">__iterator__</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> iterator
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token comment">// 暴露迭代器的next函数</span>
        <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 可能会导致栈溢出</span>
            <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token keyword">return</span> array <span class="token operator">+</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100000000000000000000</span><span class="token punctuation">)</span>
<span class="token comment">// FF下</span>
<span class="token comment">// 参考：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Iterators_and_Generators#.E5.AE.9A.E4.B9.89.E8.87.AA.E5.AE.9A.E4.B9.89.E8.BF.AD.E4.BB.A3.E5.99.A8</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> r<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 显示1到99999999999999999999</span>
<span class="token comment">// 所有浏览器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 显示1到99999999999999999999</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="核心-yield关键字"><a href="#核心-yield关键字" aria-hidden="true" class="header-anchor">#</a> 核心-yield关键字</h2> <p>yield关键字就是以一种更直观、便捷的方式让我们创建用于遍历有限序列集合的迭代器，而yield则用于将生成器函数的代码切片作为有限序列集合的元素（元素的类型为指令+数据，而不仅仅是数据而已）。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义生成器函数</span>
<span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">enumerable</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
  <span class="token keyword">var</span> msg1 <span class="token operator">=</span> <span class="token keyword">yield</span> msg <span class="token operator">+</span> <span class="token string">'  after '</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg1<span class="token punctuation">)</span>
  <span class="token keyword">var</span> msg2 <span class="token operator">=</span> <span class="token keyword">yield</span> msg1 <span class="token operator">+</span> <span class="token string">' after'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg2 <span class="token operator">+</span> <span class="token string">' over'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上述代码最终会被解析为下面的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">enumerable</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token operator">++</span>state<span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">' after'</span><span class="token punctuation">)</span>
                  <span class="token keyword">break</span>
         <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
                  <span class="token keyword">var</span> msg1 <span class="token operator">=</span> val
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg1 <span class="token operator">+</span> <span class="token string">' after'</span><span class="token punctuation">)</span>
                  <span class="token keyword">break</span>
         <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
                  <span class="token keyword">var</span> msg2 <span class="token operator">=</span> val
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg2 <span class="token operator">+</span> <span class="token string">' over'</span><span class="token punctuation">)</span>
                  <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="异步调用中的应用"><a href="#异步调用中的应用" aria-hidden="true" class="header-anchor">#</a> 异步调用中的应用</h2> <p>由于迭代器模式实现 延迟执行/按需执行，因此可作为一种异步编程模式来应用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">getArticles</span><span class="token punctuation">(</span><span class="token string">'dummy.json'</span><span class="token punctuation">)</span>
<span class="token comment">// 开始执行</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 异步任务模型</span>
<span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>tpl<span class="token punctuation">:</span> <span class="token string">'tpl.html'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'fsjohnhuang'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getTpl</span><span class="token punctuation">(</span><span class="token parameter">tpl</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'hello ${name}'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 同步任务</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> tpl</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> tpl<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\$\{(\w+)\}/</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> data<span class="token punctuation">[</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span>  <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">?</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> data<span class="token punctuation">[</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 主逻辑</span>
<span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">getAritcles</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'begin'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span>
  <span class="token keyword">var</span> tpl <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getTpl</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>tpl<span class="token punctuation">)</span>
  <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> tpl<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>Generator Function并不是为异步编程而生，但可以将它结合Promise来实现良好的异步编程模型。</p> <p>let，其实就是块级作用域申明变量的var。
之前JS的var关键字是非块级作用域的，而是函数级的。
例如arr=[0,1,2]，我们经常写循环for(var i=0,len=arr.length; i &lt; len; i++){}，其实循环后这个i是还可以访问的2。</p> <p>这样就很容易污染环境变量。</p> <p>如果用了let，for(let i=0,len=arr.length; i&lt;len; i++){}，这时循环后的i就是undefined的了。</p> <p>function*，申明构造函数，返回{value:v,done:true_or_false}。
构造函数可以调用next来获取下一个值，可以构造类似于随机数生成器。
yield和function*一起使用。在构造器函数中，yield可以暂停然后返回当前表达式的值。</p> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> gen<span class="token operator">=</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>执行了构造a函数的第一行yield 1后，a函数退出并且保存上下文，当再次执行next时会恢复a函数上下文继续执行下一行b。</p> <p>promise，这个非ECMA6特性，主要是为了解决多层嵌套的问题。将嵌套回调转化成链式调用。</p> <h3 id="概念"><a href="#概念" aria-hidden="true" class="header-anchor">#</a> 概念</h3> <p>yield和yield*都是配合Generator进行使用的。</p> <h3 id="yield"><a href="#yield" aria-hidden="true" class="header-anchor">#</a> yield</h3> <p>yield是关键字，其语法如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>rv<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token punctuation">[</span>expression<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>expression：是Generator函数返回的遍历器对象调用next方法是所得到的值；
rv：是遍历其对象调用next方法是传递给next方法的参数</p> <p>这里要简单的说一下next方法，其语法如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>value：传递给Generator函数的值，也就是上文中的rv</p> <p>这里比较有意思的就是传递给next方法的值value，下面通过例子来看一下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">_testYieldExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    value <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'yield value'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`1 value is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出1</span>

    value <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'yield value'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`2 value is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出2</span>
    <span class="token keyword">return</span> <span class="token string">'over'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> _testIterator <span class="token operator">=</span> <span class="token function">_testYieldExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> _res <span class="token operator">=</span> _testIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`1:no params to next, result is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_res<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出3</span>

_res <span class="token operator">=</span> _testIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'params from next'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`2:params to next, result is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_res<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出4</span>

_res <span class="token operator">=</span> _testIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`3:params to next, result is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_res<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>输出如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span><span class="token punctuation">:</span>no params to next<span class="token punctuation">,</span> result is<span class="token punctuation">:</span> <span class="token keyword">yield</span> value
<span class="token number">1</span> value is<span class="token punctuation">:</span> params <span class="token keyword">from</span> next
<span class="token number">2</span><span class="token punctuation">:</span>params to next<span class="token punctuation">,</span> result is<span class="token punctuation">:</span> <span class="token keyword">yield</span> value
<span class="token number">2</span> value is<span class="token punctuation">:</span> <span class="token keyword">undefined</span>
<span class="token number">3</span><span class="token punctuation">:</span>params to next<span class="token punctuation">,</span> result is<span class="token punctuation">:</span> over
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>注释中标记了几个输出语句，输出1是在第二次调用next方法是执行，可以看到，此时的value值是传递给next方法的参数，但是在_testYieldExpression函数中可以看到value = yield 'yield value'，所以可以理解为，在第一次执行next函数的时候，语句yield 'yield value'没有返回值，并且没有赋值给value，而在第二次调用next时，才将next函数的参数赋值给value。虽然有些混乱，但是如果打断点来看的话会更加清晰。</p> <h3 id="yield-2"><a href="#yield-2" aria-hidden="true" class="header-anchor">#</a> yield*</h3> <p>yield*是表达式，因此有返回值，其语法如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">yield</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>expression<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>expression：是可遍历对象，可以是数组，也可以是另外一个Generator函数的执行表达式，等等</p> <p>其实说简单点，就是将多个yield语句根据某种规则合并为一个，示例如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">g3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token string">'34'</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">g3</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 1, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 2, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: &quot;3&quot;, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: &quot;4&quot;, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 5, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 6, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: undefined, done: true}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/note/js/math_fn.html" class="prev">
          常用的Math数学对象函数
        </a></span> <span class="next"><a href="/note/node/unexpected_token_import.html">
          编译报错Unexpected token import
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.60ce1d25.js" defer></script><script src="/assets/js/3.b2331f66.js" defer></script><script src="/assets/js/21.22431cb8.js" defer></script>
  </body>
</html>
